<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>How to organize your data for use in Python: Boxplot example with statistical calculations.</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="David Schryer">

    <!-- Le styles -->
    <link rel="stylesheet" href="http://schryer.github.io/python_course_material/theme/css/bootstrap.min.css" type="text/css" />
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
      .tag-1 {
        font-size: 13pt;
      }
      .tag-2 {
        font-size: 10pt;
      }
      .tag-2 {
        font-size: 8pt;
      }
      .tag-4 {
        font-size: 6pt;
     }
    </style>
    <link href="http://schryer.github.io/python_course_material/theme/css/bootstrap-responsive.min.css" rel="stylesheet">
        <link href="http://schryer.github.io/python_course_material/theme/css/font-awesome.css" rel="stylesheet">

    <link href="http://schryer.github.io/python_course_material/theme/css/pygments.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="http://schryer.github.io/python_course_material/theme/images/favicon.ico">
    <link rel="apple-touch-icon" href="http://schryer.github.io/python_course_material/theme/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://schryer.github.io/python_course_material/theme/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://schryer.github.io/python_course_material/theme/images/apple-touch-icon-114x114.png">

    <link href="http://schryer.github.io/python_course_material/" type="application/atom+xml" rel="alternate" title="Scientific Programming with Python ATOM Feed" />

  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="http://schryer.github.io/python_course_material/index.html">Scientific Programming with Python </a>
          <div class="nav-collapse">
            <ul class="nav">
                  <li><a href="/python_course_material/">Home</a></li>
                  <li><a href="/python_course_material/ipython/">Getting started with IPython notebook</a></li>
                  <li><a href="/python_course_material/python/">Python notebooks</a></li>

                          <ul class="nav pull-right">
                                <li><a href="http://schryer.github.io/python_course_material/archives.html"><i class="icon-th-list"></i>Archives</a></li>
                          </ul>

            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row">
        <div class="span9" id="content">
<section id="content" class="body">
        <h1 class="entry-title">How to organize your data for use in Python: Boxplot example with statistical calculations.</h1>
        <p>Download original file: <a href="http://schryer.github.io/python_course_material/notebooks/9_Organizing_your_data_and_boxplot.ipynb">9_Organizing_your_data_and_boxplot.ipynb</a></p>
<p>View original file in nbviewer: <a href="http://nbviewer.ipython.org/url/schryer.github.io/python_course_material/notebooks/9_Organizing_your_data_and_boxplot.ipynb">9_Organizing_your_data_and_boxplot.ipynb</a></p>
<h2>Organizing your&nbsp;data</h2>
<p>Because spreadsheets are very flexable, people use
them in very different ways and often organize their
data in a form that is easy for humans to understand,
but non-trivial for computers to&nbsp;parse.</p>
<p>We will take two sheets from one spreadsheet (<code>stats_data.xlsx</code>)
to illustrate this point (<code>dirty_sheet</code> and <code>clean_sheet</code>).
The sheet we call <code>clean_sheet</code> is a reorganized form of the
original data in <code>dirty_sheet</code>.  If you open up this file in
a spreadsheet program, you will note that the original user
had re-organized this data to plot it, so the original form
was not even a good choice for use by the spreadsheet program&nbsp;itself.</p>
<p>The general rule to organizing data is to keep data of the same
nature together.  Usually, this means data with the same units
and measured in the same&nbsp;way.</p>
<div class="highlight"><pre><span class="n">import</span> <span class="n">pandas</span> 
<span class="n">fn</span> <span class="o">=</span> <span class="err">&#39;</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">stats_data</span><span class="p">.</span><span class="n">xlsx</span><span class="err">&#39;</span>
<span class="n">dirty_df</span> <span class="o">=</span> <span class="n">pandas</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">dirty_sheet</span><span class="err">&#39;</span><span class="p">)</span>
<span class="n">clean_df</span> <span class="o">=</span> <span class="n">pandas</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">clean_sheet</span><span class="err">&#39;</span><span class="p">)</span>


<span class="n">clean_df</span>
</pre></div>


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>exposure_time_h</th>
      <th>dose_ug</th>
      <th>mouse</th>
      <th>day</th>
      <th>mouse_weight_g</th>
      <th>lung_weight_g</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0 </th>
      <td>  0</td>
      <td>   0</td>
      <td> 0</td>
      <td> 22</td>
      <td> 22.15</td>
      <td> 0.78</td>
    </tr>
    <tr>
      <th>1 </th>
      <td>  0</td>
      <td>   0</td>
      <td> 1</td>
      <td> 25</td>
      <td> 27.76</td>
      <td> 0.70</td>
    </tr>
    <tr>
      <th>2 </th>
      <td>  0</td>
      <td>   0</td>
      <td> 2</td>
      <td> 22</td>
      <td> 24.00</td>
      <td> 0.97</td>
    </tr>
    <tr>
      <th>3 </th>
      <td>  0</td>
      <td>   0</td>
      <td> 3</td>
      <td> 24</td>
      <td> 22.74</td>
      <td> 1.32</td>
    </tr>
    <tr>
      <th>4 </th>
      <td>  0</td>
      <td>   0</td>
      <td> 4</td>
      <td> 22</td>
      <td> 23.02</td>
      <td> 1.08</td>
    </tr>
    <tr>
      <th>5 </th>
      <td>  0</td>
      <td>   0</td>
      <td> 5</td>
      <td> 25</td>
      <td> 23.68</td>
      <td> 1.27</td>
    </tr>
    <tr>
      <th>6 </th>
      <td>  0</td>
      <td>   0</td>
      <td> 6</td>
      <td> 25</td>
      <td> 20.22</td>
      <td> 0.74</td>
    </tr>
    <tr>
      <th>7 </th>
      <td>  0</td>
      <td>   0</td>
      <td> 7</td>
      <td> 22</td>
      <td> 22.17</td>
      <td> 1.25</td>
    </tr>
    <tr>
      <th>8 </th>
      <td>  6</td>
      <td> 200</td>
      <td> 0</td>
      <td> 25</td>
      <td> 18.46</td>
      <td> 1.12</td>
    </tr>
    <tr>
      <th>9 </th>
      <td>  6</td>
      <td> 200</td>
      <td> 1</td>
      <td> 25</td>
      <td> 19.16</td>
      <td> 0.88</td>
    </tr>
    <tr>
      <th>10</th>
      <td>  6</td>
      <td> 200</td>
      <td> 2</td>
      <td> 25</td>
      <td> 19.69</td>
      <td> 1.04</td>
    </tr>
    <tr>
      <th>11</th>
      <td>  6</td>
      <td> 200</td>
      <td> 3</td>
      <td> 25</td>
      <td> 18.95</td>
      <td> 0.97</td>
    </tr>
    <tr>
      <th>12</th>
      <td>  6</td>
      <td> 200</td>
      <td> 4</td>
      <td> 25</td>
      <td> 26.83</td>
      <td> 0.85</td>
    </tr>
    <tr>
      <th>13</th>
      <td>  6</td>
      <td> 200</td>
      <td> 5</td>
      <td> 25</td>
      <td> 26.24</td>
      <td> 0.81</td>
    </tr>
    <tr>
      <th>14</th>
      <td>  6</td>
      <td> 200</td>
      <td> 6</td>
      <td> 25</td>
      <td> 30.65</td>
      <td> 0.86</td>
    </tr>
    <tr>
      <th>15</th>
      <td>  6</td>
      <td> 200</td>
      <td> 7</td>
      <td> 24</td>
      <td> 22.07</td>
      <td> 1.14</td>
    </tr>
    <tr>
      <th>16</th>
      <td> 24</td>
      <td> 200</td>
      <td> 0</td>
      <td> 25</td>
      <td> 25.54</td>
      <td> 1.19</td>
    </tr>
    <tr>
      <th>17</th>
      <td> 24</td>
      <td> 200</td>
      <td> 2</td>
      <td> 25</td>
      <td> 19.04</td>
      <td> 0.15</td>
    </tr>
    <tr>
      <th>18</th>
      <td> 24</td>
      <td> 200</td>
      <td> 3</td>
      <td> 25</td>
      <td> 20.65</td>
      <td> 1.15</td>
    </tr>
    <tr>
      <th>19</th>
      <td> 24</td>
      <td> 200</td>
      <td> 4</td>
      <td> 25</td>
      <td> 20.42</td>
      <td> 0.99</td>
    </tr>
    <tr>
      <th>20</th>
      <td> 24</td>
      <td> 200</td>
      <td> 5</td>
      <td> 24</td>
      <td> 20.07</td>
      <td> 1.26</td>
    </tr>
    <tr>
      <th>21</th>
      <td> 24</td>
      <td> 200</td>
      <td> 6</td>
      <td> 24</td>
      <td> 25.04</td>
      <td> 1.29</td>
    </tr>
    <tr>
      <th>22</th>
      <td> 24</td>
      <td> 200</td>
      <td> 7</td>
      <td> 25</td>
      <td> 24.80</td>
      <td> 1.07</td>
    </tr>
    <tr>
      <th>23</th>
      <td> 72</td>
      <td> 200</td>
      <td> 0</td>
      <td> 25</td>
      <td> 18.51</td>
      <td> 1.31</td>
    </tr>
    <tr>
      <th>24</th>
      <td> 72</td>
      <td> 200</td>
      <td> 1</td>
      <td> 24</td>
      <td> 19.14</td>
      <td> 1.15</td>
    </tr>
    <tr>
      <th>25</th>
      <td> 72</td>
      <td> 200</td>
      <td> 2</td>
      <td> 24</td>
      <td> 16.97</td>
      <td> 1.02</td>
    </tr>
    <tr>
      <th>26</th>
      <td> 72</td>
      <td> 200</td>
      <td> 3</td>
      <td> 23</td>
      <td> 19.78</td>
      <td> 1.57</td>
    </tr>
    <tr>
      <th>27</th>
      <td> 72</td>
      <td> 200</td>
      <td> 4</td>
      <td> 25</td>
      <td> 16.97</td>
      <td> 1.42</td>
    </tr>
    <tr>
      <th>28</th>
      <td> 72</td>
      <td> 200</td>
      <td> 5</td>
      <td> 25</td>
      <td> 17.74</td>
      <td> 1.31</td>
    </tr>
    <tr>
      <th>29</th>
      <td> 72</td>
      <td> 200</td>
      <td> 6</td>
      <td> 25</td>
      <td> 18.61</td>
      <td> 1.33</td>
    </tr>
    <tr>
      <th>30</th>
      <td> 72</td>
      <td> 200</td>
      <td> 7</td>
      <td> 24</td>
      <td> 18.31</td>
      <td> 1.30</td>
    </tr>
    <tr>
      <th>31</th>
      <td> 72</td>
      <td> 400</td>
      <td> 0</td>
      <td> 25</td>
      <td> 27.29</td>
      <td> 0.57</td>
    </tr>
    <tr>
      <th>32</th>
      <td> 72</td>
      <td> 400</td>
      <td> 1</td>
      <td> 25</td>
      <td> 30.03</td>
      <td> 1.09</td>
    </tr>
    <tr>
      <th>33</th>
      <td> 72</td>
      <td> 400</td>
      <td> 2</td>
      <td> 25</td>
      <td> 27.47</td>
      <td> 0.35</td>
    </tr>
    <tr>
      <th>34</th>
      <td> 72</td>
      <td> 400</td>
      <td> 3</td>
      <td> 25</td>
      <td> 23.62</td>
      <td> 0.80</td>
    </tr>
    <tr>
      <th>35</th>
      <td> 72</td>
      <td> 400</td>
      <td> 4</td>
      <td> 25</td>
      <td> 23.28</td>
      <td> 0.38</td>
    </tr>
    <tr>
      <th>36</th>
      <td> 72</td>
      <td> 400</td>
      <td> 5</td>
      <td> 25</td>
      <td> 28.21</td>
      <td> 0.91</td>
    </tr>
    <tr>
      <th>37</th>
      <td> 72</td>
      <td> 400</td>
      <td> 6</td>
      <td> 25</td>
      <td> 29.40</td>
      <td> 0.25</td>
    </tr>
    <tr>
      <th>38</th>
      <td> 72</td>
      <td> 400</td>
      <td> 7</td>
      <td> 25</td>
      <td> 30.37</td>
      <td> 0.18</td>
    </tr>
  </tbody>
</table>
</div>

<h3>After reading <code>clean_sheet</code> into <code>clean_df</code>, we can easily workd with&nbsp;this</h3>
<p>data</p>
<p>First we add another column, <code>lung_weight_fraction</code> which is the fraction of the
mouse weight that is lung (including&nbsp;tumors):</p>
<div class="highlight"><pre><span class="n">clean_df</span><span class="p">[</span><span class="err">&#39;</span><span class="n">lung_weight_fraction</span><span class="err">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clean_df</span><span class="p">[</span><span class="err">&#39;</span><span class="n">lung_weight_g</span><span class="err">&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">clean_df</span><span class="p">[</span><span class="err">&#39;</span><span class="n">mouse_weight_g</span><span class="err">&#39;</span><span class="p">]</span>
</pre></div>


<p>Next, we orgnaize the data into separate trials, with data from each trial
having the same dose and exposure time.  We could have done this in the
spreadsheet, but this illustrates how to group data using <code>Python</code>.</p>
<div class="highlight"><pre><span class="cp"># Here we go through all possible combinations of </span>
<span class="cp"># exposure time and dose and only add data that we </span>
<span class="cp"># find.   </span>
<span class="n">exposure_times</span> <span class="o">=</span> <span class="n">set</span><span class="p">(</span><span class="n">clean_df</span><span class="p">[</span><span class="err">&#39;</span><span class="n">exposure_time_h</span><span class="err">&#39;</span><span class="p">])</span>
<span class="n">dosages</span> <span class="o">=</span> <span class="n">set</span><span class="p">(</span><span class="n">clean_df</span><span class="p">[</span><span class="err">&#39;</span><span class="n">dose_ug</span><span class="err">&#39;</span><span class="p">])</span>

<span class="n">trial_dfs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">et</span> <span class="n">in</span> <span class="n">exposure_times</span><span class="o">:</span>
    <span class="k">for</span> <span class="n">dose</span> <span class="n">in</span> <span class="n">dosages</span><span class="o">:</span>

        <span class="err">#</span> <span class="n">We</span> <span class="n">use</span> <span class="n">the</span> <span class="n">query</span> <span class="n">method</span> <span class="n">to</span> <span class="n">extract</span> <span class="n">all</span> <span class="n">the</span> <span class="n">data</span> <span class="n">from</span> <span class="n">one</span> <span class="n">trial</span> <span class="n">into</span> <span class="n">its</span>
        <span class="err">#</span> <span class="n">own</span> <span class="n">DataFrame</span><span class="p">.</span>
        <span class="n">query_string</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">exposure_time_h</span> <span class="o">==</span> <span class="p">{}</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="p">{}</span><span class="err">&#39;</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">et</span><span class="p">,</span> <span class="n">dose</span><span class="p">)</span>
        <span class="n">print</span><span class="p">(</span><span class="err">&#39;</span><span class="n">Executing</span> <span class="n">query</span><span class="o">:</span> <span class="err">&#39;</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span>
        <span class="n">trial_df</span> <span class="o">=</span> <span class="n">clean_df</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">query_string</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">trial_df</span><span class="p">.</span><span class="n">empty</span><span class="o">:</span>
            <span class="n">print</span><span class="p">(</span><span class="err">&#39;</span>  <span class="n">No</span> <span class="n">data</span> <span class="n">found</span> <span class="k">for</span> <span class="n">query</span><span class="o">:</span> <span class="err">&#39;</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">exp_key</span> <span class="o">=</span> <span class="err">&#39;</span><span class="p">{}</span><span class="n">_</span><span class="p">{}</span><span class="err">&#39;</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">et</span><span class="p">,</span> <span class="n">dose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">exp_key</span> <span class="o">==</span> <span class="err">&#39;</span><span class="mi">0</span><span class="n">_0</span><span class="err">&#39;</span><span class="o">:</span>
            <span class="n">exp_key</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">control</span><span class="err">&#39;</span>

        <span class="n">print</span><span class="p">(</span><span class="err">&#39;</span>  <span class="n">Data</span> <span class="n">found</span><span class="p">.</span> <span class="n">Adding</span> <span class="n">trial_df</span> <span class="n">under</span> <span class="n">the</span> <span class="n">experiment_key</span><span class="o">:</span> <span class="err">&#39;</span><span class="p">,</span> <span class="n">exp_key</span><span class="p">)</span>

        <span class="n">trial_dfs</span><span class="p">[</span><span class="n">exp_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">trial_df</span>

<span class="n">Executing</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">0</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">0</span>
  <span class="n">Data</span> <span class="n">found</span><span class="p">.</span> <span class="n">Adding</span> <span class="n">trial_df</span> <span class="n">under</span> <span class="n">the</span> <span class="n">experiment_key</span><span class="o">:</span>  <span class="n">control</span>
<span class="n">Executing</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">0</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">200</span>
  <span class="n">No</span> <span class="n">data</span> <span class="n">found</span> <span class="k">for</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">0</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">200</span>
<span class="n">Executing</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">0</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">400</span>
  <span class="n">No</span> <span class="n">data</span> <span class="n">found</span> <span class="k">for</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">0</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">400</span>
<span class="n">Executing</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">24</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">0</span>
  <span class="n">No</span> <span class="n">data</span> <span class="n">found</span> <span class="k">for</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">24</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">Executing</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">24</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">200</span>
  <span class="n">Data</span> <span class="n">found</span><span class="p">.</span> <span class="n">Adding</span> <span class="n">trial_df</span> <span class="n">under</span> <span class="n">the</span> <span class="n">experiment_key</span><span class="o">:</span>  <span class="mi">24</span><span class="n">_200</span>
<span class="n">Executing</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">24</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">400</span>
  <span class="n">No</span> <span class="n">data</span> <span class="n">found</span> <span class="k">for</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">24</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">400</span>
<span class="n">Executing</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">72</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">0</span>
  <span class="n">No</span> <span class="n">data</span> <span class="n">found</span> <span class="k">for</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">72</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">Executing</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">72</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">200</span>
  <span class="n">Data</span> <span class="n">found</span><span class="p">.</span> <span class="n">Adding</span> <span class="n">trial_df</span> <span class="n">under</span> <span class="n">the</span> <span class="n">experiment_key</span><span class="o">:</span>  <span class="mi">72</span><span class="n">_200</span>
<span class="n">Executing</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">72</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">400</span>
  <span class="n">Data</span> <span class="n">found</span><span class="p">.</span> <span class="n">Adding</span> <span class="n">trial_df</span> <span class="n">under</span> <span class="n">the</span> <span class="n">experiment_key</span><span class="o">:</span>  <span class="mi">72</span><span class="n">_400</span>
<span class="n">Executing</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">6</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">0</span>
  <span class="n">No</span> <span class="n">data</span> <span class="n">found</span> <span class="k">for</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">6</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">Executing</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">6</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">200</span>
  <span class="n">Data</span> <span class="n">found</span><span class="p">.</span> <span class="n">Adding</span> <span class="n">trial_df</span> <span class="n">under</span> <span class="n">the</span> <span class="n">experiment_key</span><span class="o">:</span>  <span class="mi">6</span><span class="n">_200</span>
<span class="n">Executing</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">6</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">400</span>
  <span class="n">No</span> <span class="n">data</span> <span class="n">found</span> <span class="k">for</span> <span class="n">query</span><span class="o">:</span>  <span class="n">exposure_time_h</span> <span class="o">==</span> <span class="mi">6</span> <span class="n">and</span> <span class="n">dose_ug</span> <span class="o">==</span> <span class="mi">400</span>
</pre></div>


<p>Now we make a box plot with one box for each&nbsp;trial.</p>
<div class="highlight"><pre><span class="c">%matplotlib inline</span>
<span class="n">import</span> <span class="n">matplotlib</span><span class="p">.</span><span class="n">pylab</span> <span class="n">as</span> <span class="n">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="p">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="p">=(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

# <span class="n">We</span> <span class="n">sort</span> <span class="n">the</span> <span class="n">DataFrames</span> <span class="n">by</span> <span class="n">their</span> <span class="n">median</span> <span class="n">values</span><span class="p">.</span>
<span class="n">ordered_trials</span> <span class="p">=</span> <span class="n">sorted</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s">&#39;lung_weight_fraction&#39;</span><span class="p">].</span><span class="n">median</span><span class="p">(),</span> <span class="n">exp_key</span><span class="p">)</span> 
                         <span class="k">for</span> <span class="n">exp_key</span><span class="p">,</span> <span class="n">df</span> <span class="n">in</span> <span class="n">trial_dfs</span><span class="p">.</span><span class="n">items</span><span class="p">())</span>

# <span class="n">We</span> <span class="n">only</span> <span class="n">keep</span> <span class="n">the</span> <span class="n">experimental</span> <span class="n">keys</span><span class="p">.</span>
<span class="n">labels</span> <span class="p">=</span> <span class="p">[</span><span class="n">exp_key</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">exp_key</span> <span class="n">in</span> <span class="n">ordered_trials</span><span class="p">]</span>

# <span class="n">The</span> <span class="n">boxplot</span> <span class="n">method</span> <span class="n">requires</span> <span class="n">a</span> <span class="n">list</span> <span class="n">of</span> <span class="n">lists</span><span class="p">,</span> <span class="n">with</span> <span class="n">each</span> <span class="n">inner</span> <span class="n">list</span> 
# <span class="n">being</span> <span class="n">the</span> <span class="n">data</span> <span class="n">from</span> <span class="n">one</span> <span class="n">trial</span><span class="p">.</span>
<span class="n">X</span> <span class="p">=</span> <span class="p">[</span><span class="n">trial_dfs</span><span class="p">[</span><span class="n">exp_key</span><span class="p">][</span><span class="s">&#39;lung_weight_fraction&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">exp_key</span> <span class="n">in</span> <span class="n">labels</span><span class="p">]</span>

# <span class="n">The</span> <span class="n">bootstrap</span> <span class="n">keyword</span> <span class="n">specifies</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">iterations</span> <span class="n">used</span> <span class="n">to</span> 
# <span class="n">bootstrap</span> <span class="n">the</span> <span class="mi">95</span><span class="c">% confidance intervals for each box.</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">bootstrap</span><span class="p">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Fraction of weight that is lung.&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;time(h)_dose($\mu$g) or control&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Lung tumor trials sorted by the median value of the fractional weight of lung.&#39;</span><span class="p">)</span>

<span class="n">xtick_names</span> <span class="p">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">xticklabels</span><span class="p">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">setp</span><span class="p">(</span><span class="n">xtick_names</span><span class="p">,</span> <span class="n">rotation</span><span class="p">=</span><span class="mi">30</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<p><img alt="png" src="images/9_Organizing_your_data_and_boxplot_GENERATED_by_add_links_8_0.png" /></p>
<p>Finally, we can calculate the p-values for rejecting the null hypothesis that
the mean values between these trials are&nbsp;different.</p>
<div class="highlight"><pre><span class="n">import</span> <span class="n">scipy</span><span class="p">.</span><span class="n">stats</span> <span class="n">as</span> <span class="n">stats</span>

<span class="cp"># We don&#39;t need to assume that the variances are the same.</span>
<span class="n">control_and_first</span> <span class="o">=</span> <span class="n">stats</span><span class="p">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">equal_var</span><span class="o">=</span><span class="n">False</span><span class="p">)</span>
<span class="n">control_and_last</span> <span class="o">=</span> <span class="n">stats</span><span class="p">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">equal_var</span><span class="o">=</span><span class="n">False</span><span class="p">)</span>

<span class="n">print</span><span class="p">(</span><span class="err">&#39;</span><span class="n">The</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="n">between</span> <span class="n">control</span> <span class="n">and</span> <span class="n">trial</span> <span class="mi">72</span><span class="n">_400</span> <span class="n">is</span><span class="o">:</span> <span class="err">&#39;</span><span class="p">,</span> <span class="n">control_and_first</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">print</span><span class="p">(</span><span class="err">&#39;</span><span class="n">The</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="n">between</span> <span class="n">control</span> <span class="n">and</span> <span class="n">trial</span> <span class="mi">72</span><span class="n">_200</span> <span class="n">is</span><span class="o">:</span> <span class="err">&#39;</span><span class="p">,</span> <span class="n">control_and_last</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">The</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="n">between</span> <span class="n">control</span> <span class="n">and</span> <span class="n">trial</span> <span class="mi">72</span><span class="n">_400</span> <span class="n">is</span><span class="o">:</span>  <span class="mf">0.0015037647302</span>
<span class="n">The</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="n">between</span> <span class="n">control</span> <span class="n">and</span> <span class="n">trial</span> <span class="mi">72</span><span class="n">_200</span> <span class="n">is</span><span class="o">:</span>  <span class="mf">0.000135155817627</span>
</pre></div>


<h2>Conclusion:</h2>
<p>Both 72h samples seem to have mean values that are different from control, but
in opposite&nbsp;directions.</p>
</section>
        </div><!--/span-->

                <div class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">

<li class="nav-header"><h4><i class="icon-folder-close icon-large"></i>Categories</h4></li>

<li class="nav-header"><h4><i class="icon-tags icon-large"></i>Tags</h4></li>


</ul>        </div><!--/.well -->

      </div><!--/row-->

      <hr>

      <footer>
        <address id="about">
                Proudly powered by <a href="http://pelican.notmyidea.org/">Pelican <i class="icon-external-link"></i></a>,
                                which takes great advantage of <a href="http://python.org">Python <i class="icon-external-link"></i></a>.
        </address><!-- /#about -->

        <p>The theme is from <a href="http://twitter.github.com/bootstrap/">Bootstrap from Twitter <i class="icon-external-link"></i></a>,
                   and <a href="http://fortawesome.github.com/Font-Awesome/">Font-Awesome <i class="icon-external-link"></i></a>, thanks!</p>
      </footer>

    </div><!--/.fluid-container-->



    <!-- Le javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://schryer.github.io/python_course_material/theme/js/jquery-1.7.2.min.js"></script>
    <script src="http://schryer.github.io/python_course_material/theme/js/bootstrap.min.js"></script>
  </body>
</html>