<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Introduction to sequence alignment, Entrez database retrieval and curve fitting.</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="David Schryer">

    <!-- Le styles -->
    <link rel="stylesheet" href="http://schryer.github.io/python_course_material/theme/css/bootstrap.min.css" type="text/css" />
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
      .tag-1 {
        font-size: 13pt;
      }
      .tag-2 {
        font-size: 10pt;
      }
      .tag-2 {
        font-size: 8pt;
      }
      .tag-4 {
        font-size: 6pt;
     }
    </style>
    <link href="http://schryer.github.io/python_course_material/theme/css/bootstrap-responsive.min.css" rel="stylesheet">
        <link href="http://schryer.github.io/python_course_material/theme/css/font-awesome.css" rel="stylesheet">

    <link href="http://schryer.github.io/python_course_material/theme/css/pygments.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="http://schryer.github.io/python_course_material/theme/images/favicon.ico">
    <link rel="apple-touch-icon" href="http://schryer.github.io/python_course_material/theme/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://schryer.github.io/python_course_material/theme/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://schryer.github.io/python_course_material/theme/images/apple-touch-icon-114x114.png">

    <link href="http://schryer.github.io/python_course_material/" type="application/atom+xml" rel="alternate" title="Scientific Programming with Python ATOM Feed" />

  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="http://schryer.github.io/python_course_material/index.html">Scientific Programming with Python </a>
          <div class="nav-collapse">
            <ul class="nav">
                  <li><a href="/python_course_material/">Home</a></li>
                  <li><a href="/python_course_material/ipython/">Getting started with IPython notebook</a></li>
                  <li><a href="/python_course_material/python/">Python notebooks</a></li>

                          <ul class="nav pull-right">
                                <li><a href="http://schryer.github.io/python_course_material/archives.html"><i class="icon-th-list"></i>Archives</a></li>
                          </ul>

            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row">
        <div class="span9" id="content">
<section id="content" class="body">
        <h1 class="entry-title">Introduction to sequence alignment, Entrez database retrieval and curve fitting.</h1>
        <p>Download original file: <a href="http://schryer.github.io/python_course_material/notebooks/7_introduction_to_sequence_alignment_Entrez_and_curve_fitting.ipynb">7_introduction_to_sequence_alignment_Entrez_and_curve_fitting.ipynb</a></p>
<p>View original file in nbviewer: <a href="http://nbviewer.ipython.org/url/schryer.github.io/python_course_material/notebooks/7_introduction_to_sequence_alignment_Entrez_and_curve_fitting.ipynb">7_introduction_to_sequence_alignment_Entrez_and_curve_fitting.ipynb</a></p>
<div class="highlight"><pre><span class="n">from</span> <span class="n">Bio</span> <span class="n">import</span> <span class="n">pairwise2</span>
</pre></div>


<h3>Task:</h3>
<p>You have two sequences:
seq1 = &#8216;<span class="caps">ACGTCCTTCATT</span>&#8217;
seq2 = &#8216;<span class="caps">GTCTCATG</span>&#8217;</p>
<p>You have a scoring scheme where
<em> a match gives you +1
</em> a mismatch gives you 0
* gap opening costs&nbsp;−10</p>
<p>Find the best alignment of the two&nbsp;sequences.</p>
<p>You have a scoring scheme where:
<em> a match gives you +1
</em> a mismatch gives you −1
* gap opening costs you&nbsp;−1</p>
<p>Find the best alignment of the two&nbsp;sequences.</p>
<p><span class="caps">HINT</span>: look at the following documentation page
for Biopython:
http://biopython.org/<span class="caps">DIST</span>/docs/api/Bio.pairwise2-module.html</p>
<div class="highlight"><pre><span class="n">seq1</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">ACGTCCTTCATT</span><span class="err">&#39;</span>
<span class="n">seq2</span> <span class="o">=</span>  <span class="err">&#39;</span><span class="n">GTCTCATG</span><span class="err">&#39;</span>
<span class="n">pairwise2</span><span class="p">.</span><span class="n">align</span><span class="p">.</span><span class="n">localms</span><span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000000</span><span class="p">)</span>




<span class="p">[(</span><span class="err">&#39;</span><span class="n">ACGTCCTTCATT</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">----</span><span class="n">GTCTCATG</span><span class="err">&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
 <span class="p">(</span><span class="err">&#39;</span><span class="n">ACGTCCTTCATT</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">----</span><span class="n">GTCTCATG</span><span class="err">&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">)]</span>




<span class="n">pairwise2</span><span class="p">.</span><span class="n">align</span><span class="p">.</span><span class="n">localms</span><span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000000</span><span class="p">)</span>




<span class="p">[(</span><span class="err">&#39;</span><span class="n">ACGTCCTTCATT</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">--</span><span class="n">GTC</span><span class="o">-</span><span class="n">T</span><span class="o">-</span><span class="n">CATG</span><span class="err">&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
 <span class="p">(</span><span class="err">&#39;</span><span class="n">ACGTCCTTCATT</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">--</span><span class="n">GT</span><span class="o">-</span><span class="n">CT</span><span class="o">-</span><span class="n">CATG</span><span class="err">&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
 <span class="p">(</span><span class="err">&#39;</span><span class="n">ACGTCCTTCATT</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">--</span><span class="n">GT</span><span class="o">-</span><span class="n">C</span><span class="o">-</span><span class="n">TCATG</span><span class="err">&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">)]</span>
</pre></div>


<h3>The format_alignment&nbsp;function</h3>
<p>pairwise2 has a format_alignment function to better visualize the alignment&nbsp;output.</p>
<div class="highlight"><pre><span class="n">out_tuplesA</span> <span class="o">=</span> <span class="n">pairwise2</span><span class="p">.</span><span class="n">align</span><span class="p">.</span><span class="n">localms</span><span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000000</span><span class="p">)</span>
<span class="n">out_tuplesB</span> <span class="o">=</span> <span class="n">pairwise2</span><span class="p">.</span><span class="n">align</span><span class="p">.</span><span class="n">localms</span><span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">print</span><span class="p">(</span><span class="err">&#39;</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="n">inf</span><span class="o">:</span><span class="err">&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ot</span> <span class="n">in</span> <span class="n">out_tuplesA</span><span class="o">:</span>
    <span class="n">print</span><span class="p">(</span><span class="n">pairwise2</span><span class="p">.</span><span class="n">format_alignment</span><span class="p">(</span><span class="o">*</span><span class="n">ot</span><span class="p">))</span>

<span class="n">print</span><span class="p">(</span><span class="err">&#39;\</span><span class="n">n1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">inf</span><span class="o">:</span><span class="err">&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ot</span> <span class="n">in</span> <span class="n">out_tuplesB</span><span class="o">:</span>
    <span class="n">print</span><span class="p">(</span><span class="n">pairwise2</span><span class="p">.</span><span class="n">format_alignment</span><span class="p">(</span><span class="o">*</span><span class="n">ot</span><span class="p">))</span>

<span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="n">inf</span><span class="o">:</span>
<span class="n">ACGTCCTTCATT</span>
       <span class="o">|||||</span>
<span class="o">----</span><span class="n">GTCTCATG</span>
  <span class="n">Score</span><span class="o">=</span><span class="mi">4</span>

<span class="n">ACGTCCTTCATT</span>
       <span class="o">||||</span>
<span class="o">----</span><span class="n">GTCTCATG</span>
  <span class="n">Score</span><span class="o">=</span><span class="mi">4</span>


<span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">inf</span><span class="o">:</span>
<span class="n">ACGTCCTTCATT</span>
  <span class="o">|||||||||</span>
<span class="o">--</span><span class="n">GTC</span><span class="o">-</span><span class="n">T</span><span class="o">-</span><span class="n">CATG</span>
  <span class="n">Score</span><span class="o">=</span><span class="mi">5</span>

<span class="n">ACGTCCTTCATT</span>
  <span class="o">|||||||||</span>
<span class="o">--</span><span class="n">GT</span><span class="o">-</span><span class="n">CT</span><span class="o">-</span><span class="n">CATG</span>
  <span class="n">Score</span><span class="o">=</span><span class="mi">5</span>

<span class="n">ACGTCCTTCATT</span>
  <span class="o">|||||||||</span>
<span class="o">--</span><span class="n">GT</span><span class="o">-</span><span class="n">C</span><span class="o">-</span><span class="n">TCATG</span>
  <span class="n">Score</span><span class="o">=</span><span class="mi">5</span>

<span class="n">ACGTCCTTCATT</span>
  <span class="o">|||||||||</span>
<span class="o">--</span><span class="n">GTC</span><span class="o">--</span><span class="n">TCATG</span>
  <span class="n">Score</span><span class="o">=</span><span class="mi">5</span>
</pre></div>


<h3>Using the Entrez databases via&nbsp;Biopython</h3>
<p>You can access all of the information in the Entrez databases
via Biopython, although a new Python package, Bioservices, is
probably easier and provides access to <span class="caps">MANY</span> different online
databases.&nbsp;https://pythonhosted.org/bioservices/</p>
<div class="highlight"><pre><span class="n">from</span> <span class="n">Bio</span> <span class="n">import</span> <span class="n">Entrez</span>
<span class="n">Entrez</span><span class="p">.</span><span class="n">email</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">schryer</span><span class="err">@</span><span class="n">gmail</span><span class="p">.</span><span class="n">com</span><span class="err">&#39;</span>


<span class="n">handle</span> <span class="o">=</span> <span class="n">Entrez</span><span class="p">.</span><span class="n">einfo</span><span class="p">()</span>
<span class="n">record</span> <span class="o">=</span> <span class="n">Entrez</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
<span class="n">record</span><span class="p">[</span><span class="err">&#39;</span><span class="n">DbList</span><span class="err">&#39;</span><span class="p">]</span>

<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">david</span><span class="o">/</span><span class="n">pyenvs</span><span class="o">/</span><span class="n">py3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.4</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">Bio</span><span class="o">/</span><span class="n">Entrez</span><span class="o">/</span><span class="n">Parser</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="mi">525</span><span class="o">:</span> <span class="n">UserWarning</span><span class="o">:</span> <span class="n">Unable</span> <span class="n">to</span> <span class="n">load</span> <span class="n">DTD</span> <span class="n">file</span> <span class="n">einfo</span><span class="p">.</span><span class="n">dtd</span><span class="p">.</span>

<span class="n">Bio</span><span class="p">.</span><span class="n">Entrez</span> <span class="n">uses</span> <span class="n">NCBI</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">DTD</span> <span class="n">files</span> <span class="n">to</span> <span class="n">parse</span> <span class="n">XML</span> <span class="n">files</span> <span class="n">returned</span> <span class="n">by</span> <span class="n">NCBI</span> <span class="n">Entrez</span><span class="p">.</span>
<span class="n">Though</span> <span class="n">most</span> <span class="n">of</span> <span class="n">NCBI</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">DTD</span> <span class="n">files</span> <span class="n">are</span> <span class="n">included</span> <span class="n">in</span> <span class="n">the</span> <span class="n">Biopython</span> <span class="n">distribution</span><span class="p">,</span>
<span class="n">sometimes</span> <span class="n">you</span> <span class="n">may</span> <span class="n">find</span> <span class="n">that</span> <span class="n">a</span> <span class="n">particular</span> <span class="n">DTD</span> <span class="n">file</span> <span class="n">is</span> <span class="n">missing</span><span class="p">.</span> <span class="n">While</span> <span class="n">we</span> <span class="n">can</span>
<span class="n">access</span> <span class="n">the</span> <span class="n">DTD</span> <span class="n">file</span> <span class="n">through</span> <span class="n">the</span> <span class="n">internet</span><span class="p">,</span> <span class="n">the</span> <span class="n">parser</span> <span class="n">is</span> <span class="n">much</span> <span class="n">faster</span> <span class="k">if</span> <span class="n">the</span>
<span class="n">required</span> <span class="n">DTD</span> <span class="n">files</span> <span class="n">are</span> <span class="n">available</span> <span class="n">locally</span><span class="p">.</span>

<span class="n">For</span> <span class="n">this</span> <span class="n">purpose</span><span class="p">,</span> <span class="n">please</span> <span class="n">download</span> <span class="n">einfo</span><span class="p">.</span><span class="n">dtd</span> <span class="n">from</span>

<span class="nl">http:</span><span class="c1">//eutils.ncbi.nlm.nih.gov/eutils/dtd/20130322/einfo.dtd</span>

<span class="n">and</span> <span class="n">save</span> <span class="n">it</span> <span class="n">either</span> <span class="n">in</span> <span class="n">directory</span>

<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">david</span><span class="o">/</span><span class="n">pyenvs</span><span class="o">/</span><span class="n">py3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.4</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">Bio</span><span class="o">/</span><span class="n">Entrez</span><span class="o">/</span><span class="n">DTDs</span>

<span class="n">or</span> <span class="n">in</span> <span class="n">directory</span>

<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">david</span><span class="o">/</span><span class="p">.</span><span class="n">biopython</span><span class="o">/</span><span class="n">Bio</span><span class="o">/</span><span class="n">Entrez</span><span class="o">/</span><span class="n">DTDs</span>

<span class="n">in</span> <span class="n">order</span> <span class="k">for</span> <span class="n">Bio</span><span class="p">.</span><span class="n">Entrez</span> <span class="n">to</span> <span class="n">find</span> <span class="n">it</span><span class="p">.</span>

<span class="n">Alternatively</span><span class="p">,</span> <span class="n">you</span> <span class="n">can</span> <span class="n">save</span> <span class="n">einfo</span><span class="p">.</span><span class="n">dtd</span> <span class="n">in</span> <span class="n">the</span> <span class="n">directory</span>
<span class="n">Bio</span><span class="o">/</span><span class="n">Entrez</span><span class="o">/</span><span class="n">DTDs</span> <span class="n">in</span> <span class="n">the</span> <span class="n">Biopython</span> <span class="n">distribution</span><span class="p">,</span> <span class="n">and</span> <span class="n">reinstall</span> <span class="n">Biopython</span><span class="p">.</span>

<span class="n">Please</span> <span class="n">also</span> <span class="n">inform</span> <span class="n">the</span> <span class="n">Biopython</span> <span class="n">developers</span> <span class="n">about</span> <span class="n">this</span> <span class="n">missing</span> <span class="n">DTD</span><span class="p">,</span> <span class="n">by</span>
<span class="n">reporting</span> <span class="n">a</span> <span class="n">bug</span> <span class="n">on</span> <span class="n">https</span><span class="o">:</span><span class="c1">//github.com/biopython/biopython/issues or sign</span>
<span class="n">up</span> <span class="n">to</span> <span class="n">our</span> <span class="n">mailing</span> <span class="n">list</span> <span class="n">and</span> <span class="n">emailing</span> <span class="n">us</span><span class="p">,</span> <span class="n">so</span> <span class="n">that</span> <span class="n">we</span> <span class="n">can</span> <span class="n">include</span> <span class="n">it</span> <span class="n">with</span> <span class="n">the</span>
<span class="n">next</span> <span class="n">release</span> <span class="n">of</span> <span class="n">Biopython</span><span class="p">.</span>

<span class="n">Proceeding</span> <span class="n">to</span> <span class="n">access</span> <span class="n">the</span> <span class="n">DTD</span> <span class="n">file</span> <span class="n">through</span> <span class="n">the</span> <span class="n">internet</span><span class="p">...</span>

  <span class="n">warnings</span><span class="p">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>





<span class="p">[</span><span class="err">&#39;</span><span class="n">pubmed</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">protein</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">nuccore</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">nucleotide</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">nucgss</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">nucest</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">structure</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">genome</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">assembly</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">genomeprj</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">bioproject</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">biosample</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">blastdbinfo</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">books</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">cdd</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">clinvar</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">clone</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">gap</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">gapplus</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">dbvar</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">epigenomics</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">gene</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">gds</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">geoprofiles</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">homologene</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">medgen</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">journals</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">mesh</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">ncbisearch</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">nlmcatalog</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">omim</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">orgtrack</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">pmc</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">popset</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">probe</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">proteinclusters</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">pcassay</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">biosystems</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">pccompound</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">pcsubstance</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">pubmedhealth</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">seqannot</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">snp</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">sra</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">taxonomy</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">toolkit</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">toolkitall</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">toolkitbook</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">unigene</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">gencoll</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">gtr</span><span class="err">&#39;</span><span class="p">]</span>




<span class="n">handle</span> <span class="o">=</span> <span class="n">Entrez</span><span class="p">.</span><span class="n">einfo</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="err">&#39;</span><span class="n">pubmed</span><span class="err">&#39;</span><span class="p">)</span>
<span class="n">record</span> <span class="o">=</span> <span class="n">Entrez</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
<span class="n">record</span><span class="p">[</span><span class="err">&#39;</span><span class="n">DbInfo</span><span class="err">&#39;</span><span class="p">][</span><span class="err">&#39;</span><span class="n">Description</span><span class="err">&#39;</span><span class="p">]</span>




<span class="err">&#39;</span><span class="n">PubMed</span> <span class="n">bibliographic</span> <span class="n">record</span><span class="err">&#39;</span>




<span class="n">handle</span> <span class="o">=</span> <span class="n">Entrez</span><span class="p">.</span><span class="n">esearch</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="err">&#39;</span><span class="n">pubmed</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">term</span><span class="o">=</span><span class="err">&#39;</span><span class="n">persister</span><span class="err">&#39;</span><span class="p">)</span>
<span class="n">record</span> <span class="o">=</span> <span class="n">Entrez</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
<span class="n">record</span><span class="p">[</span><span class="err">&#39;</span><span class="n">IdList</span><span class="err">&#39;</span><span class="p">]</span>

<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">david</span><span class="o">/</span><span class="n">pyenvs</span><span class="o">/</span><span class="n">py3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.4</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">Bio</span><span class="o">/</span><span class="n">Entrez</span><span class="o">/</span><span class="n">Parser</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="mi">525</span><span class="o">:</span> <span class="n">UserWarning</span><span class="o">:</span> <span class="n">Unable</span> <span class="n">to</span> <span class="n">load</span> <span class="n">DTD</span> <span class="n">file</span> <span class="n">esearch</span><span class="p">.</span><span class="n">dtd</span><span class="p">.</span>

<span class="n">Bio</span><span class="p">.</span><span class="n">Entrez</span> <span class="n">uses</span> <span class="n">NCBI</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">DTD</span> <span class="n">files</span> <span class="n">to</span> <span class="n">parse</span> <span class="n">XML</span> <span class="n">files</span> <span class="n">returned</span> <span class="n">by</span> <span class="n">NCBI</span> <span class="n">Entrez</span><span class="p">.</span>
<span class="n">Though</span> <span class="n">most</span> <span class="n">of</span> <span class="n">NCBI</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">DTD</span> <span class="n">files</span> <span class="n">are</span> <span class="n">included</span> <span class="n">in</span> <span class="n">the</span> <span class="n">Biopython</span> <span class="n">distribution</span><span class="p">,</span>
<span class="n">sometimes</span> <span class="n">you</span> <span class="n">may</span> <span class="n">find</span> <span class="n">that</span> <span class="n">a</span> <span class="n">particular</span> <span class="n">DTD</span> <span class="n">file</span> <span class="n">is</span> <span class="n">missing</span><span class="p">.</span> <span class="n">While</span> <span class="n">we</span> <span class="n">can</span>
<span class="n">access</span> <span class="n">the</span> <span class="n">DTD</span> <span class="n">file</span> <span class="n">through</span> <span class="n">the</span> <span class="n">internet</span><span class="p">,</span> <span class="n">the</span> <span class="n">parser</span> <span class="n">is</span> <span class="n">much</span> <span class="n">faster</span> <span class="k">if</span> <span class="n">the</span>
<span class="n">required</span> <span class="n">DTD</span> <span class="n">files</span> <span class="n">are</span> <span class="n">available</span> <span class="n">locally</span><span class="p">.</span>

<span class="n">For</span> <span class="n">this</span> <span class="n">purpose</span><span class="p">,</span> <span class="n">please</span> <span class="n">download</span> <span class="n">esearch</span><span class="p">.</span><span class="n">dtd</span> <span class="n">from</span>

<span class="nl">http:</span><span class="c1">//eutils.ncbi.nlm.nih.gov/eutils/dtd/20060628/esearch.dtd</span>

<span class="n">and</span> <span class="n">save</span> <span class="n">it</span> <span class="n">either</span> <span class="n">in</span> <span class="n">directory</span>

<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">david</span><span class="o">/</span><span class="n">pyenvs</span><span class="o">/</span><span class="n">py3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.4</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">Bio</span><span class="o">/</span><span class="n">Entrez</span><span class="o">/</span><span class="n">DTDs</span>

<span class="n">or</span> <span class="n">in</span> <span class="n">directory</span>

<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">david</span><span class="o">/</span><span class="p">.</span><span class="n">biopython</span><span class="o">/</span><span class="n">Bio</span><span class="o">/</span><span class="n">Entrez</span><span class="o">/</span><span class="n">DTDs</span>

<span class="n">in</span> <span class="n">order</span> <span class="k">for</span> <span class="n">Bio</span><span class="p">.</span><span class="n">Entrez</span> <span class="n">to</span> <span class="n">find</span> <span class="n">it</span><span class="p">.</span>

<span class="n">Alternatively</span><span class="p">,</span> <span class="n">you</span> <span class="n">can</span> <span class="n">save</span> <span class="n">esearch</span><span class="p">.</span><span class="n">dtd</span> <span class="n">in</span> <span class="n">the</span> <span class="n">directory</span>
<span class="n">Bio</span><span class="o">/</span><span class="n">Entrez</span><span class="o">/</span><span class="n">DTDs</span> <span class="n">in</span> <span class="n">the</span> <span class="n">Biopython</span> <span class="n">distribution</span><span class="p">,</span> <span class="n">and</span> <span class="n">reinstall</span> <span class="n">Biopython</span><span class="p">.</span>

<span class="n">Please</span> <span class="n">also</span> <span class="n">inform</span> <span class="n">the</span> <span class="n">Biopython</span> <span class="n">developers</span> <span class="n">about</span> <span class="n">this</span> <span class="n">missing</span> <span class="n">DTD</span><span class="p">,</span> <span class="n">by</span>
<span class="n">reporting</span> <span class="n">a</span> <span class="n">bug</span> <span class="n">on</span> <span class="n">https</span><span class="o">:</span><span class="c1">//github.com/biopython/biopython/issues or sign</span>
<span class="n">up</span> <span class="n">to</span> <span class="n">our</span> <span class="n">mailing</span> <span class="n">list</span> <span class="n">and</span> <span class="n">emailing</span> <span class="n">us</span><span class="p">,</span> <span class="n">so</span> <span class="n">that</span> <span class="n">we</span> <span class="n">can</span> <span class="n">include</span> <span class="n">it</span> <span class="n">with</span> <span class="n">the</span>
<span class="n">next</span> <span class="n">release</span> <span class="n">of</span> <span class="n">Biopython</span><span class="p">.</span>

<span class="n">Proceeding</span> <span class="n">to</span> <span class="n">access</span> <span class="n">the</span> <span class="n">DTD</span> <span class="n">file</span> <span class="n">through</span> <span class="n">the</span> <span class="n">internet</span><span class="p">...</span>

  <span class="n">warnings</span><span class="p">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>





<span class="p">[</span><span class="err">&#39;</span><span class="mi">25304862</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">25302955</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">25283595</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">25267859</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">25254624</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">25245998</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">25203125</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">25192989</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">25144274</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">25130648</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">25120957</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">25118250</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">25102868</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">25100240</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">25049258</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">25041421</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">24987115</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">24891106</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">24885389</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mi">24837402</span><span class="err">&#39;</span><span class="p">]</span>




<span class="n">handle</span> <span class="o">=</span> <span class="n">Entrez</span><span class="p">.</span><span class="n">efetch</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="err">&#39;</span><span class="n">pubmed</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">id</span><span class="o">=</span><span class="err">&#39;</span><span class="mi">25267859</span><span class="err">&#39;</span><span class="p">)</span>
<span class="n">print</span><span class="p">(</span><span class="n">handle</span><span class="p">.</span><span class="n">read</span><span class="p">())</span>


<span class="n">Pubmed</span><span class="o">-</span><span class="n">entry</span> <span class="o">::=</span> <span class="p">{</span>
  <span class="n">pmid</span> <span class="mi">25267859</span><span class="p">,</span>
  <span class="n">medent</span> <span class="p">{</span>
    <span class="n">em</span> <span class="n">std</span> <span class="p">{</span>
      <span class="n">year</span> <span class="mi">2014</span><span class="p">,</span>
      <span class="n">month</span> <span class="mi">9</span><span class="p">,</span>
      <span class="n">day</span> <span class="mi">30</span>
    <span class="p">},</span>
    <span class="n">cit</span> <span class="p">{</span>
      <span class="n">title</span> <span class="p">{</span>
        <span class="n">name</span> <span class="s">&quot;Controlling bacterial behavior with indole-containing natural</span>
 <span class="n">products</span> <span class="n">and</span> <span class="n">derivatives</span><span class="p">.</span><span class="s">&quot;</span>
      <span class="p">},</span>
      <span class="n">authors</span> <span class="p">{</span>
        <span class="n">names</span> <span class="n">std</span> <span class="p">{</span>
          <span class="p">{</span>
            <span class="n">name</span> <span class="n">ml</span> <span class="s">&quot;Melander RJ&quot;</span><span class="p">,</span>
            <span class="n">affil</span> <span class="n">str</span> <span class="s">&quot;Department of Chemistry, North Carolina State</span>
 <span class="n">University</span><span class="p">,</span> <span class="n">Raleigh</span><span class="p">,</span> <span class="n">NC</span><span class="p">,</span> <span class="mf">27695.</span><span class="s">&quot;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="n">name</span> <span class="n">ml</span> <span class="s">&quot;Minvielle MJ&quot;</span><span class="p">,</span>
            <span class="n">affil</span> <span class="n">str</span> <span class="s">&quot;Department of Chemistry, North Carolina State</span>
 <span class="n">University</span><span class="p">,</span> <span class="n">Raleigh</span><span class="p">,</span> <span class="n">NC</span><span class="p">,</span> <span class="mf">27695.</span><span class="s">&quot;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="n">name</span> <span class="n">ml</span> <span class="s">&quot;Melander C&quot;</span><span class="p">,</span>
            <span class="n">affil</span> <span class="n">str</span> <span class="s">&quot;Department of Chemistry, North Carolina State</span>
 <span class="n">University</span><span class="p">,</span> <span class="n">Raleigh</span><span class="p">,</span> <span class="n">NC</span><span class="p">,</span> <span class="mf">27695.</span><span class="s">&quot;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="n">from</span> <span class="n">journal</span> <span class="p">{</span>
        <span class="n">title</span> <span class="p">{</span>
          <span class="n">iso</span><span class="o">-</span><span class="n">jta</span> <span class="s">&quot;Tetrahedron&quot;</span><span class="p">,</span>
          <span class="n">ml</span><span class="o">-</span><span class="n">jta</span> <span class="s">&quot;Tetrahedron&quot;</span><span class="p">,</span>
          <span class="n">issn</span> <span class="s">&quot;0040-4020&quot;</span>
        <span class="p">},</span>
        <span class="n">imp</span> <span class="p">{</span>
          <span class="n">date</span> <span class="n">std</span> <span class="p">{</span>
            <span class="n">year</span> <span class="mi">2014</span><span class="p">,</span>
            <span class="n">month</span> <span class="mi">9</span><span class="p">,</span>
            <span class="n">day</span> <span class="mi">16</span>
          <span class="p">},</span>
          <span class="n">volume</span> <span class="s">&quot;70&quot;</span><span class="p">,</span>
          <span class="n">issue</span> <span class="s">&quot;37&quot;</span><span class="p">,</span>
          <span class="n">pages</span> <span class="s">&quot;6363-6372&quot;</span><span class="p">,</span>
          <span class="n">language</span> <span class="s">&quot;ENG&quot;</span><span class="p">,</span>
          <span class="n">pubstatus</span> <span class="n">ppublish</span><span class="p">,</span>
          <span class="n">history</span> <span class="p">{</span>
            <span class="p">{</span>
              <span class="n">pubstatus</span> <span class="n">other</span><span class="p">,</span>
              <span class="n">date</span> <span class="n">std</span> <span class="p">{</span>
                <span class="n">year</span> <span class="mi">2014</span><span class="p">,</span>
                <span class="n">month</span> <span class="mi">10</span><span class="p">,</span>
                <span class="n">day</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">hour</span> <span class="mi">6</span><span class="p">,</span>
                <span class="n">minute</span> <span class="mi">0</span>
              <span class="p">}</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="n">pubstatus</span> <span class="n">pubmed</span><span class="p">,</span>
              <span class="n">date</span> <span class="n">std</span> <span class="p">{</span>
                <span class="n">year</span> <span class="mi">2014</span><span class="p">,</span>
                <span class="n">month</span> <span class="mi">10</span><span class="p">,</span>
                <span class="n">day</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">hour</span> <span class="mi">6</span><span class="p">,</span>
                <span class="n">minute</span> <span class="mi">0</span>
              <span class="p">}</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="n">pubstatus</span> <span class="n">medline</span><span class="p">,</span>
              <span class="n">date</span> <span class="n">std</span> <span class="p">{</span>
                <span class="n">year</span> <span class="mi">2014</span><span class="p">,</span>
                <span class="n">month</span> <span class="mi">10</span><span class="p">,</span>
                <span class="n">day</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">hour</span> <span class="mi">6</span><span class="p">,</span>
                <span class="n">minute</span> <span class="mi">0</span>
              <span class="p">}</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="n">pubstatus</span> <span class="n">other</span><span class="p">,</span>
              <span class="n">date</span> <span class="n">std</span> <span class="p">{</span>
                <span class="n">year</span> <span class="mi">2015</span><span class="p">,</span>
                <span class="n">month</span> <span class="mi">9</span><span class="p">,</span>
                <span class="n">day</span> <span class="mi">16</span><span class="p">,</span>
                <span class="n">hour</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">minute</span> <span class="mi">0</span>
              <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="n">ids</span> <span class="p">{</span>
        <span class="n">doi</span> <span class="s">&quot;10.1016/j.tet.2014.05.089&quot;</span><span class="p">,</span>
        <span class="n">pubmed</span> <span class="mi">25267859</span><span class="p">,</span>
        <span class="n">other</span> <span class="p">{</span>
          <span class="n">db</span> <span class="s">&quot;pmc&quot;</span><span class="p">,</span>
          <span class="n">tag</span> <span class="n">str</span> <span class="s">&quot;PMC4175420&quot;</span>
        <span class="p">},</span>
        <span class="n">other</span> <span class="p">{</span>
          <span class="n">db</span> <span class="s">&quot;mid&quot;</span><span class="p">,</span>
          <span class="n">tag</span> <span class="n">str</span> <span class="s">&quot;NIHMS601941&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="n">abstract</span> <span class="s">&quot;Indole has recently been implicated as an important small</span>
 <span class="n">molecule</span> <span class="n">signal</span> <span class="n">utilized</span> <span class="n">by</span> <span class="n">many</span> <span class="n">bacteria</span> <span class="n">to</span> <span class="n">coordinate</span> <span class="n">various</span> <span class="n">forms</span> <span class="n">of</span>
 <span class="n">behavior</span><span class="p">.</span> <span class="n">Indole</span> <span class="n">plays</span> <span class="n">a</span> <span class="n">role</span> <span class="n">in</span> <span class="n">numerous</span> <span class="n">bacterial</span> <span class="n">processes</span><span class="p">,</span> <span class="n">including</span><span class="o">:</span>
 <span class="n">biofilm</span> <span class="n">formation</span> <span class="n">and</span> <span class="n">maintenance</span><span class="p">,</span> <span class="n">virulence</span> <span class="n">factor</span> <span class="n">production</span><span class="p">,</span> <span class="n">antibiotic</span>
 <span class="n">resistance</span> <span class="n">and</span> <span class="n">persister</span> <span class="n">cell</span> <span class="n">formation</span><span class="p">.</span> <span class="n">Intercepting</span> <span class="n">indole</span><span class="o">-</span><span class="n">signaling</span>
 <span class="n">pathways</span> <span class="n">with</span> <span class="n">appropriately</span> <span class="n">designed</span> <span class="n">small</span> <span class="n">molecules</span> <span class="n">provides</span> <span class="n">a</span> <span class="n">n</span> <span class="n">opportunity</span>
 <span class="n">to</span> <span class="n">control</span> <span class="n">unwanted</span> <span class="n">bacterial</span> <span class="n">behaviors</span><span class="p">,</span> <span class="n">and</span> <span class="n">is</span> <span class="n">an</span> <span class="n">attractive</span> <span class="n">anti</span><span class="o">-</span><span class="n">virulence</span>
 <span class="n">therapeutic</span> <span class="n">strategy</span><span class="p">.</span> <span class="n">In</span> <span class="n">this</span> <span class="n">review</span><span class="p">,</span> <span class="n">we</span> <span class="n">give</span> <span class="n">an</span> <span class="n">overview</span> <span class="n">of</span> <span class="n">the</span> <span class="n">process</span>
 <span class="n">controlled</span> <span class="n">by</span> <span class="n">indole</span> <span class="n">signaling</span><span class="p">,</span> <span class="n">and</span> <span class="n">summarize</span> <span class="n">current</span> <span class="n">efforts</span> <span class="n">to</span> <span class="n">design</span>
 <span class="n">indole</span><span class="o">-</span><span class="n">containing</span> <span class="n">small</span> <span class="n">molecules</span> <span class="n">to</span> <span class="n">intercept</span> <span class="n">these</span> <span class="n">pathways</span><span class="p">,</span> <span class="n">and</span> <span class="n">detail</span> <span class="n">the</span>
 <span class="n">synthetic</span> <span class="n">efforts</span> <span class="n">towards</span> <span class="n">accessing</span> <span class="n">indole</span> <span class="n">derived</span> <span class="n">bioactive</span> <span class="n">small</span> <span class="n">molecules</span><span class="p">.</span><span class="s">&quot;,</span>
    <span class="n">idnum</span> <span class="p">{</span>
      <span class="s">&quot;R01 GM055769/GM/NIGMS NIH HHS&quot;</span>
    <span class="p">},</span>
    <span class="n">pmid</span> <span class="mi">25267859</span><span class="p">,</span>
    <span class="n">pub</span><span class="o">-</span><span class="n">type</span> <span class="p">{</span>
      <span class="s">&quot;JOURNAL ARTICLE&quot;</span>
    <span class="p">},</span>
    <span class="n">status</span> <span class="n">publisher</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h3>Curve&nbsp;fitting</h3>
<p>One common task for biologists is to fit experimental data
to a function. For example, one may want to fit a 4 parameter
logistic equation to enzyme-linked immunosorbent assay (<span class="caps">ELISA</span>)
data. The usual formula for this model&nbsp;is:</p>
<p><mathjax>$f(x) = \frac{A - D}{1 + \left(\frac{x}{C}\right)^B} + D$</mathjax>,</p>
<p>where <mathjax>$x$</mathjax> is the concentration, <mathjax>$A$</mathjax> is the minimum asymptote, <mathjax>$B$</mathjax> is the
steepness, <mathjax>$C$</mathjax> is the inflection point and <mathjax>$D$</mathjax> is the maximum&nbsp;asymptote.</p>
<div class="highlight"><pre><span class="c">%matplotlib inline</span>
<span class="n">import</span> <span class="n">numpy</span> <span class="n">as</span> <span class="n">np</span>
<span class="n">import</span> <span class="n">matplotlib</span><span class="p">.</span><span class="n">pyplot</span> <span class="n">as</span> <span class="n">plt</span>
<span class="n">from</span> <span class="n">scipy</span><span class="p">.</span><span class="n">optimize</span> <span class="n">import</span> <span class="n">leastsq</span>

<span class="n">def</span> <span class="n">logistic4</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">):</span>
    <span class="s">&#39;&#39;&#39;Four parameter logistic equation.</span>

<span class="s">    $f(x) = \frac{A - D}{1 + \left(\frac{x}{C}\right)^B} + D$</span>
<span class="s">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">A</span><span class="o">-</span><span class="n">D</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="p">((</span><span class="n">x</span><span class="o">/</span><span class="n">C</span><span class="p">)</span><span class="o">**</span><span class="n">B</span><span class="p">)))</span> <span class="o">+</span> <span class="n">D</span>

<span class="n">def</span> <span class="n">residuals</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="s">&#39;&#39;&#39;Deviations of data from logistic4&#39;&#39;&#39;</span>
    <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span> <span class="p">=</span> <span class="n">parameters</span>
    <span class="n">err</span> <span class="p">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">logistic4</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">err</span>

# <span class="n">Make</span> <span class="n">up</span> <span class="n">some</span> <span class="n">data</span> <span class="k">for</span> <span class="n">fitting</span> <span class="n">and</span> <span class="n">add</span> <span class="n">noise</span>
# <span class="n">In</span> <span class="n">practice</span><span class="p">,</span> <span class="n">y_meas</span> <span class="n">would</span> <span class="n">be</span> <span class="n">read</span> <span class="n">in</span> <span class="n">from</span> <span class="n">a</span> <span class="n">file</span>
<span class="n">x_measured</span> <span class="p">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">x_true</span> <span class="p">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

# <span class="n">True</span> <span class="n">parameter</span> <span class="n">values</span>
<span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span> <span class="p">=</span> <span class="n">true_parameters</span> <span class="p">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mf">7.3</span>
<span class="n">y_true</span> <span class="p">=</span> <span class="n">logistic4</span><span class="p">(</span><span class="n">x_true</span><span class="p">,</span> <span class="o">*</span><span class="n">true_parameters</span><span class="p">)</span>#<span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>

# <span class="n">Simulated</span> <span class="n">measurements</span> <span class="n">of</span> <span class="n">data</span><span class="p">.</span>
<span class="n">y_measured</span> <span class="p">=</span> <span class="n">logistic4</span><span class="p">(</span><span class="n">x_measured</span><span class="p">,</span> <span class="o">*</span><span class="n">true_parameters</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nb">randn</span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">x_measured</span><span class="p">))</span>

# <span class="n">Initial</span> <span class="n">guess</span> <span class="k">for</span> <span class="n">parameters</span>
<span class="n">initial_parameters</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

# <span class="n">Fit</span> <span class="n">equation</span> <span class="n">using</span> <span class="n">least</span> <span class="n">squares</span> <span class="n">optimization</span>
<span class="n">leastsq_output</span> <span class="p">=</span> <span class="n">leastsq</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">initial_parameters</span><span class="p">,</span> <span class="n">full_output</span><span class="p">=</span><span class="n">True</span><span class="p">,</span> <span class="n">args</span><span class="p">=(</span><span class="n">x_measured</span><span class="p">,</span> <span class="n">y_measured</span><span class="p">))</span>

# <span class="n">Plot</span> <span class="n">results</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_true</span><span class="p">,</span> <span class="n">logistic4</span><span class="p">(</span><span class="n">x_true</span><span class="p">,</span> <span class="o">*</span><span class="n">leastsq_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s">&#39;r--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_measured</span><span class="p">,</span> <span class="n">y_measured</span><span class="p">,</span> <span class="s">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_true</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="s">&#39;g-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Least squares fit to logistic equation with noisy data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">([</span><span class="s">&#39;Fit&#39;</span><span class="p">,</span> <span class="s">&#39;Data&#39;</span><span class="p">,</span> <span class="s">&#39;True&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="p">=</span><span class="s">&#39;upper left&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="s">&#39;Parameter   True   Estimated&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">estimated_value</span> <span class="n">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">leastsq_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">param_key</span> <span class="p">=</span> <span class="s">&#39;ABCD&#39;</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="n">true_value</span> <span class="p">=</span> <span class="n">true_parameters</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="n">plot_text</span> <span class="p">=</span> <span class="s">&#39;{:&gt;10} {:&gt;12.2f} {:&gt;10.2f}&#39;</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">param_key</span><span class="p">,</span> <span class="n">true_value</span><span class="p">,</span> <span class="n">estimated_value</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="o">-</span><span class="n">index</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">plot_text</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<p><img alt="png" src="images/7_introduction_to_sequence_alignment_Entrez_and_curve_fitting_GENERATED_by_add_links_13_0.png" /></p>
<div class="highlight"><pre><span class="n">import</span> <span class="n">pandas</span> <span class="n">as</span> <span class="n">pd</span>


<span class="n">filename</span> <span class="o">=</span> <span class="err">&#39;</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">python_excel</span><span class="p">.</span><span class="n">xlsx</span><span class="err">&#39;</span>


<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>


<span class="n">df</span><span class="p">.</span><span class="n">columns</span>
<span class="n">df</span><span class="p">[</span><span class="err">&#39;</span><span class="n">weight</span><span class="err">&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="err">&#39;</span><span class="n">weight</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>




<span class="n">array</span><span class="p">([[</span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="p">.</span><span class="n">axes</span><span class="p">.</span><span class="n">AxesSubplot</span> <span class="n">object</span> <span class="n">at</span> <span class="mh">0x7f6549a044e0</span><span class="o">&gt;</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">object</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="images/7_introduction_to_sequence_alignment_Entrez_and_curve_fitting_GENERATED_by_add_links_17_1.png" /></p>
<div class="highlight"><pre><span class="nx">df</span><span class="cp">[</span><span class="s1">&#39;weight_squared&#39;</span><span class="cp">]</span> <span class="o">=</span> <span class="nx">df</span><span class="cp">[</span><span class="s1">&#39;weight&#39;</span><span class="cp">]</span> <span class="o">**</span> <span class="mi">2</span>


<span class="nx">s</span> <span class="o">=</span> <span class="nx">pd</span><span class="p">.</span><span class="nx">Series</span><span class="p">(</span><span class="cp">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="cp">]</span><span class="p">)</span>


<span class="nx">df</span><span class="cp">[</span><span class="s1">&#39;random_series&#39;</span><span class="cp">]</span> <span class="o">=</span> <span class="nx">s</span>


<span class="nx">del</span> <span class="nx">df</span><span class="cp">[</span><span class="s1">&#39;random_series&#39;</span><span class="cp">]</span>


<span class="k">for</span> <span class="nx">column_name</span> <span class="k">in</span> <span class="nx">df</span><span class="p">.</span><span class="nx">columns</span><span class="o">:</span>
    <span class="k">if</span> <span class="nx">column_name</span> <span class="nx">not</span> <span class="k">in</span> <span class="cp">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;weight_squared&#39;</span><span class="cp">]</span><span class="o">:</span>
        <span class="nx">del</span> <span class="nx">df</span><span class="cp">[</span><span class="nb">column_name</span><span class="cp">]</span>


<span class="nx">df</span><span class="p">.</span><span class="nx">to_excel</span><span class="p">(</span><span class="s1">&#39;small_table.xls&#39;</span><span class="p">,</span> <span class="s1">&#39;Year Weight Weight squared&#39;</span><span class="p">)</span>


<span class="nx">ls</span>

<span class="mi">1</span><span class="nx">_reading_python_code</span><span class="p">.</span><span class="nx">ipynb</span>
<span class="mi">2</span><span class="nx">_fundamental_python_types</span><span class="p">.</span><span class="nx">ipynb</span>
<span class="mi">3</span><span class="nx">_python_strings_as_containers</span><span class="p">.</span><span class="nx">ipynb</span>
<span class="mi">4</span><span class="nx">_python_keywords</span><span class="p">.</span><span class="nx">ipynb</span>
<span class="mi">5</span><span class="nx">_elementwise_and_vector_operations</span><span class="p">.</span><span class="nx">ipynb</span>
<span class="mi">6</span><span class="nx">_functions_with_tests</span><span class="p">.</span><span class="nx">ipynb</span>
<span class="mi">7</span><span class="nx">_introduction_to_sequence_alignment_Entrez_and_curve_fitting</span><span class="p">.</span><span class="nx">ipynb</span>
<span class="mi">8</span><span class="nx">_questions_from_unit_6</span><span class="p">.</span><span class="nx">ipynb</span>
<span class="nx">python_PART_4</span><span class="p">.</span><span class="nx">ipynb</span>
<span class="nx">python_PART_5</span><span class="p">.</span><span class="nx">ipynb</span>
<span class="nx">python_PART_6</span><span class="p">.</span><span class="nx">ipynb</span>
<span class="nx">sequence_data</span><span class="p">.</span><span class="nx">tsv</span>
<span class="nx">small_table</span><span class="p">.</span><span class="nx">xls</span>
<span class="nx">X_</span><span class="p">.</span><span class="nx">ipynb</span>
</pre></div><script type= "text/javascript">
    if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
        var mathjaxscript = document.createElement('script');
        mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
        mathjaxscript.type = 'text/javascript';
        mathjaxscript.src = 'https:' == document.location.protocol
                ? 'https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'
                : 'http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
        mathjaxscript[(window.opera ? "innerHTML" : "text")] =
            "MathJax.Hub.Config({" +
            "    config: ['MMLorHTML.js']," +
            "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
            "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
            "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
            "    displayAlign: 'center'," +
            "    displayIndent: '0em'," +
            "    showMathMenu: true," +
            "    tex2jax: { " +
            "        inlineMath: [ ['$','$'] ], " +
            "        displayMath: [ ['$$','$$'] ]," +
            "        processEscapes: true," +
            "        preview: 'TeX'," +
            "    }, " +
            "    'HTML-CSS': { " +
            "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
            "    } " +
            "}); ";
        (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
    }
</script>

</section>
        </div><!--/span-->

                <div class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">

<li class="nav-header"><h4><i class="icon-folder-close icon-large"></i>Categories</h4></li>

<li class="nav-header"><h4><i class="icon-tags icon-large"></i>Tags</h4></li>


</ul>        </div><!--/.well -->

      </div><!--/row-->

      <hr>

      <footer>
        <address id="about">
                Proudly powered by <a href="http://pelican.notmyidea.org/">Pelican <i class="icon-external-link"></i></a>,
                                which takes great advantage of <a href="http://python.org">Python <i class="icon-external-link"></i></a>.
        </address><!-- /#about -->

        <p>The theme is from <a href="http://twitter.github.com/bootstrap/">Bootstrap from Twitter <i class="icon-external-link"></i></a>,
                   and <a href="http://fortawesome.github.com/Font-Awesome/">Font-Awesome <i class="icon-external-link"></i></a>, thanks!</p>
      </footer>

    </div><!--/.fluid-container-->



    <!-- Le javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://schryer.github.io/python_course_material/theme/js/jquery-1.7.2.min.js"></script>
    <script src="http://schryer.github.io/python_course_material/theme/js/bootstrap.min.js"></script>
  </body>
</html>